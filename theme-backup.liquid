<!doctype html>

<html class="" lang="{{ shop.locale }}">
  <head>
    <meta charset="utf-8"> 
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0, user-scalable=0">
    <meta name="theme-color" content="{{ settings.accent_color }}">
    <meta name="google-site-verification" content="iPyblCMQ11fUnICDlYgxMGfrJdZaM-ncX3DI5AaXW5Q" />
    <meta name="google-site-verification" content="wkYIYynBxB7U9hQySbA0ngANMws-YgWSWAsQbqJZkhs" />
    <meta name="google-site-verification" content="1vgoY1IPZJZ4rhsJwkwkSovAqM32yNBpzNXvJqOy9rY" />
    <script async src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.4/axios.min.js" integrity="sha512-lTLt+W7MrmDfKam+r3D2LURu0F47a3QaW5nF0c6Hl0JDZ57ruei+ovbg7BrZ+0bjVJ5YgzsAWE+RreERbpPE1g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!--     <script type="text/javascript" defer> document.documentElement.className = document.documentElement.className.replace('no-js', 'js'); </script> -->

    {% comment %}
    	------------------------------
    	CSS FOR DOOFINDER STYLING
       	------------------------------
    {% endcomment %}
    <style>
      .dfd-footer{
        display: none !important;
      }
      .dfd-fullscreen .dfd-layer {
        background: white !important;
      }
      .dfd-fullscreen .dfd-carousel-arrow svg{
        fill: pink !important;
      }
      .dfd-mobile [data-dfd-role=voice-search] svg {
        fill: pink !important;
      }
      .dfd-fullscreen .dfd-card-price--sale {
        color: black !important;
      }
      .dfd-btn-icon-circular-primary-lg{
        background: pink !important;
      }
      .dfd-card-content{
        text-align: center;
      }
      .dfd-fullscreen .dfd-card-pricing{
        margin: auto !important;
      }
      .dfd-mobile .dfd-card-price--sale {
        color: #454545 !important;
      }
      .dfd-mobile .dfd-card-pricing {
        margin: auto !important;
      }
      .dfd-mobile .dfd-results-grid {
        background: white;
      }
      .okeReviews-reviews-main {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
      }
      .okeReviews-reviews-review {
        max-width: 500px;
        padding: 20px !important;
        margin: 5px !important;
        min-width: 330px;
        max-width: 500px;
        border: 1px solid #e3e3e3 !important;
      }
      .okeReviews-reviewsAggregate-primary {
      	max-width: 450px;
      }
      .okeReviews.okeReviews--theme .okeReviews-reviews-showMore {
      	border: 1px solid #e3e3e3 !important;
      }
      .okeReviews .okeReviews-reviewsWidget {
      	padding: 0px !important;
      }
      .okeReviews.okeReviews--theme .okeReviews-reviewsAggregate-side {
      	display: block !important;	
      }
      .okeReviews .okeReviews-reviewsWidget--minimal.is-okeReviews-reviewsWidget-large .okeReviews-reviewsAggregate-primary-inner {
       	align-items: center;
      }
    </style>
    
    {% if page_title.size < 35 %}
        <title>
          {{ page_title }} - {{ site.name }}
        </title>
    {% else %}
        <title>
          {{ page_title }}
        </title>
    {% endif %}

    {%- if page_description -%}
    <meta name="description" content="{{ page_description | escape }}">
    {%- endif -%}

    {% if product.handle contains 'bundle-product' %}
    <meta name="robots" content="noindex,follow">

    {% assign productHandle = product.handle | split: '-bundle-product' %}

    <script>
      window.location.href = "/products/{{ productHandle[0] }}"
    </script>
    {% endif %}

    <link rel="canonical" href="{{ canonical_url }}">

    {%- if settings.favicon -%}
      <link rel="shortcut icon" href="{{ settings.favicon | img_url: '48x48' }}" type="image/png">
    {%- endif -%}

    {% render 'social-meta-tags' %}

    {% if settings.app_wk_enabled %}
    {% include 'appmate-wishlist-king' %}
    {% endif %}

    {{ content_for_header }}

    <link rel="stylesheet" href="{{ 'theme.scss.css' | asset_url }}">
    <link rel="stylesheet" href="{{ 'custom.css' | asset_url }}">

   
    
  {% include "loyaltylion" %}

  {{ shop.metafields.okendo.ReviewsWidgetStyleTag }}
  {{ shop.metafields.okendo.StyleCustomizations }}
  {% render 'okendo-reviews-json-ld' %}
  {% if template contains 'product' or page.title == "Reviews" %}
  	{{ 'okendo-reviews.js' | asset_url | script_tag }}
  {% endif %}
  
<!-- Start klevu-snippets DO NOT EDIT -->
<!-- End klevu-snippets DO NOT EDIT -->
</head>

  
  <!--DOOFINDER-SHOPIFY-->
        {% if content_for_header contains 'doofinder-installed.js' %}
        {% render 'doofinder-script-tag' %}
        {% endif %}
  <!--/DOOFINDER-SHOPIFY--></head>
  
  <body class="prestige--v4 {% if template.directory %}template-{{ template.directory | handle }}{% endif %} template-{{ template.name | handle }} template_suffix-{{ template.suffix | handle }}">

        <a class="PageSkipLink u-visually-hidden" href="#main">{{ 'header.navigation.skip_to_content' | t }}</a>
    <span class="LoadingBar"></span>
    <div class="PageOverlay"></div>
<!--     <div class="PageTransition"></div> -->

    {% section 'popup' %}
    {% section 'sidebar-menu' %}

    {%- if template != 'cart' -%}
      {% render 'cart-drawer' %}
    {%- endif -%}

    <div class="PageContainer">
      {% section 'announcement' %}
      {% section 'header' %}

      <main id="main" role="main">
        {{ content_for_layout }}
      </main>

      {% section 'footer' %}
    </div>
<!--         <script type="text/javascript" defer> document.documentElement.className = document.documentElement.className.replace('no-js', 'js'); </script> -->

    <script src="{{ 'jquery.min.js' | asset_url }}" defer></script>

    
    <script>
      // This allows to expose several variables to the global scope, to be used in scripts
      window.theme = {
        template: {{ template.name | json }},
        localeRootUrl: {% if request.locale.primary %}''{% else %}{{ request.locale.root_url | json }}{% endif %},
        shopCurrency: {{ shop.currency | json }},
        moneyFormat: {{ shop.money_format | json }},
        moneyWithCurrencyFormat: {{ shop.money_with_currency_format | json }},
        useNativeMultiCurrency: {% if shop.enabled_currencies.size > 1 %}true{% else %}false{% endif %},
        currencyConversionEnabled: {% if shop.enabled_currencies.size > 1 %}false{% else %}{{ settings.currency_conversion_enabled | json }}{% endif %},
        currencyConversionMoneyFormat: {{ settings.currency_conversion_money_format | json }},
        currencyConversionRoundAmounts: {{ settings.currency_conversion_round_amounts | json }},
        productImageSize: {{ settings.product_image_size | json }},
        searchMode: {{ settings.search_mode | json }},
        showPageTransition: {{ settings.show_page_transition | json }},
        showElementStaggering: {{ settings.show_element_staggering | json }},
        showImageZooming: {{ settings.show_image_zooming | json }}
      };

      window.languages = {
        cartAddNote: {{ 'cart.general.add_note' | t | json }},
        cartEditNote: {{ 'cart.general.edit_note' | t | json }},
        productImageLoadingError: {{ 'product.slideshow.image_loading_error' | t | json }},
        productFormAddToCart: {% if product.template_suffix == 'pre-order' %}{{ 'product.form.pre_order' | t | json }}{% else %}{{ 'product.form.add_to_cart' | t | json }}{% endif %},
        productFormUnavailable: {{ 'product.form.unavailable' | t | json }},
        productFormSoldOut: {{ 'product.form.sold_out' | t | json }},
        shippingEstimatorOneResult: {{ 'cart.shipping_estimator.one_result_title' | t | json }},
        shippingEstimatorMoreResults: {{ 'cart.shipping_estimator.more_results_title' | t | json }},
        shippingEstimatorNoResults: {{ 'cart.shipping_estimator.no_results_title' | t | json }}
      };

      window.lazySizesConfig = {
        loadHidden: false,
        hFac: 0.5,
        expFactor: 2,
        ricTimeout: 150,
        lazyClass: 'Image--lazyLoad',
        loadingClass: 'Image--lazyLoading',
        loadedClass: 'Image--lazyLoaded'
      };

//       document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
      document.documentElement.style.setProperty('--window-height', window.innerHeight + 'px');

      // We do a quick detection of some features (we could use Modernizr but for so little...)
      (function() {
        document.documentElement.className += ((window.CSS && window.CSS.supports('(position: sticky) or (position: -webkit-sticky)')) ? ' supports-sticky' : ' no-supports-sticky');
        document.documentElement.className += (window.matchMedia('(-moz-touch-enabled: 1), (hover: none)')).matches ? ' no-supports-hover' : ' supports-hover';
      }());
    </script>

    <script src="{{ 'lazysizes.min.js' | asset_url }}" defer></script>
    

    {% if settings.currency_conversion_enabled %}
      <script src="//cdn.shopify.com/s/javascripts/currencies.js" defer></script>
    {% endif %}

    {%- if template == 'customers/addresses' -%}
      <script src="{{ 'shopify_common.js' | shopify_asset_url }}" defer></script>
      <script src="{{ 'customer_area.js' | shopify_asset_url }}" defer></script>
    {%- endif -%}

    <script src="https://cdn.polyfill.io/v3/polyfill.min.js?unknown=polyfill&features=fetch,Element.prototype.closest,Element.prototype.remove,Element.prototype.classList,Array.prototype.includes,Array.prototype.fill,Object.assign,CustomEvent,IntersectionObserver,IntersectionObserverEntry,URL" defer></script>
    <script src="{{ 'libs.min.js' | asset_url }}" defer></script>
    <script src="{{ 'ajaxinate.min.js' | asset_url }}" defer></script>
    <script src="{{ 'theme.js' | asset_url }}" defer></script>
    <script src="{{ 'custom.js' | asset_url }}" defer></script>

    <script>
      (function () {
        window.onpageshow = function() {
          if (window.theme.showPageTransition) {
            var pageTransition = document.querySelector('.PageTransition');

            if (pageTransition) {
              pageTransition.style.visibility = 'visible';
              pageTransition.style.opacity = '0';
            }
          }

          // When the page is loaded from the cache, we have to reload the cart content
          document.documentElement.dispatchEvent(new CustomEvent('cart:refresh', {
            bubbles: true
          }));
        };
      })();
    </script>

    {% render 'microdata-schema' %}
<script src='https://affilo.io/libs/affiliate.lib.js' ></script> 
    
<!-- Global site tag (gtag.js) - Google Ads: 853368055 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-853368055"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-853368055');
</script>
    <script>(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:"17214689"};o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!=="loaded"&&s!=="complete"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","//bat.bing.com/bat.js","uetq");</script>    
    


    
<!--     <script type="text/javascript" src="https://s3.amazonaws.com/lastsecondcoupon/js/quickannouncementbar.js?shop=kiara-sky-professional-nails.myshopify.com"></script> -->
    
    {% render 'back-to-the-top' %}
    
  
{% include 'gtranslate', float: 'yes' %}
    
<script>
 
try{
 var klevu_isMulticurrencyEnabled = true;
 if( document.getElementById("CurrencySelector") ){
   var klevu_currentCurrencyCode = document.getElementById("CurrencySelector").value;
 }
} catch (e) {}
 </script>
    
     {{ 'https://js.klevu.com/klevu-js-v1/customizations/klevu-user-customization-159007912556112155.js' | script_tag }} 
    
    
    
<!---K Back in Stock--->
<script src="https://a.klaviyo.com/media/js/onsite/onsite.js"></script>
<script>
    var klaviyo = klaviyo || [];
    klaviyo.init({
      account: "WWqy8V",
      list: 'WnMqfs',
      platform: "shopify"
    });
    klaviyo.enable("backinstock",{ 
    trigger: {
      product_page_text: "Notify Me When Available",
      product_page_class: "Button",
      product_page_text_align: "center",
      product_page_margin: "0px",
      replace_anchor: false
    },
    modal: {
	 newsletter_subscribe_label: "Add me to the VIB list.",
     subscribe_checked: true ,
     headline: "{product_name}",
     body_content: "Register to receive a notification when this item comes back in stock.",
     email_field_label: "Email",
     button_label: "NOTIFY ME WHEN AVAILABLE",
     subscription_success_label: "You're in! We'll let you know when it's back.",
     footer_content: '',
     additional_styles: "@import url('https://fonts.googleapis.com/css?family=Helvetica+Neue');",
     drop_background_color: "#000",
     background_color: "#fff",
     text_color: "#222",
     button_text_color: "#fff",
     button_background_color: "#FEB4C4",
     close_button_color: "#ccc",
     error_background_color: "#fcd6d7",
     error_text_color: "#C72E2F",
     success_background_color: "#d3efcd",
     success_text_color: "#1B9500"
    }
  });
</script>

    <script>
      var _learnq = _learnq || [];
      _learnq.push(['identify', {
        '$email': '{{ user.email }}',
        '$first_name': '{{ user.first_name }}',
        '$last_name': '{{ user.last_name }}'
      }]);
    </script>

<!---K Web Tracking--->
<script type="application/javascript" async 
 src="https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=WWqy8V"></script>    
    
<!---Attentive Tag--->
<script src="https://cdn.attn.tv/kiarasky/dtag.js"></script>


<!-- **BEGIN** Hextom QAB Integration // Main Include - DO NOT MODIFY -->
    {% render 'hextom_qab_main', product: product, customer: customer %}
    <!-- **END** Hextom QAB Integration // Main Include - DO NOT MODIFY -->
 {% include 'smile-initializer' %}

  
  
  <!-- PickyStory code, do not modify. Safe to remove after the app is uninstalled -->
  {% if content_for_header contains 'pickystory' %}
    {% render 'pickystory-combos-prerender' %}
  {% endif %}
  <!-- PickyStory code end -->
  <!-- PickyStory snippet "main_widget_script", do not modify. Safe to remove after the app is uninstalled -->
  {% if content_for_header contains 'pickystory' %}
    <script defer src="https://cdn.pickystory.com/widget/dist/latest/pickystory-widget.min.js"></script>
  {% endif %}
  <!-- PickyStory end snippet "main_widget_script" -->
<!--Gorgias Chat Widget Start-->
    <script type="text/javascript" async defer id="gorgias-chat-widget-install-v2" src="https://config.gorgias.chat/gorgias-chat-bundle-loader.js?applicationId=9316"></script>
<script id="gorgias-chat-shopify-install">!function(_){_.SHOPIFY_PERMANENT_DOMAIN="{{shop.permanent_domain}}",_.SHOPIFY_CUSTOMER_ID="{{customer.id}}",_.SHOPIFY_CUSTOMER_EMAIL="{{customer.email}}"}(window||{});</script><!--Gorgias Chat Widget End-->
{% render 'th-subscription-scripts' %}

  {% render 'mbc-bundles' %}
    {{ 'bundles.js' | asset_url | script_tag }}

        <script>
      
          
          
      let global_gel_present = 0;
  
      console.log("clicked");
      let total_gel = 0;
      let lamp_present = [0, 0];
      jQuery.getJSON('/cart.js', function(cart) {
      	let items = cart.items;
      	console.log("THIS IS CART ORDER: ", items);

      	let cart_array = [];


      	let gel_builder_present = 0;
      	let gel_builder_total = 0;


      	for (let item of items) {
      		console.log(item.product_type);

      		if (item.id == 34589049290888) {
      			lamp_present[0] = 1;
      			lamp_present[1] += item.quantity;
      		}

      		if (item.product_type == "GEL POLISH" || item.product_type == "GEL EFFECT" || item.product_type == "gel essential" || item.product_type == "Gel Essential") {
      			total_gel += item.quantity;
      		}


      		if (item.product_id == 4670444896392 && item.final_price == 0) {
      			gel_builder_present += item.quantity;
      		} else if (item.product_id == 4670444896392 && item.final_price > 0) {
      			gel_builder_total += item.quantity;
      		}


      	}



      	let gel_required = gel_builder_total - gel_builder_present;



      	//only add in the item when there is no lamp in the cart or there is a difference

      	console.log("This is total gel: ", gel_builder_total);
      	console.log("This is gel present: ", gel_builder_present);
      	console.log("This is gel supposed: ", gel_required);



      	console.log("This is total gel: ", total_gel);
      	console.log("This is lamp present: ", lamp_present);

      	let lamp_needed = Math.trunc(total_gel / 10);

      	console.log("This is lamp needed: ", lamp_needed);

      	let lamp_supposed = lamp_needed - lamp_present[1];

      	console.log("This is lamp supposed: ", lamp_supposed);


        global_gel_present = gel_builder_total;
        
      	if (lamp_present[1] == 0 || lamp_supposed > 0) {


      		axios.post('/cart/add.js', {
      			items: [{
      				id: 34589049290888,
      				quantity: lamp_supposed
      			}]
      		}).then(function(res) {
      			document.documentElement.dispatchEvent(new CustomEvent('cart:refresh', {
      				bubbles: true
      			}));
      		})
      	}


      	if (gel_required > 0) {


      		axios.post('/cart/add.js', {
      			items: [{
      				id: 32764401287304,
      				quantity: gel_required
      			}]
      		}).then(function(res) {
      			document.documentElement.dispatchEvent(new CustomEvent('cart:refresh', {
      				bubbles: true
      			}));
      		})
      	}


      });



      function minusQuantityGels(id) {
        console.log("This is the minus quant for the bundle");
        
      
        
        
            
              jQuery.getJSON('/cart.js', function(cart) {

                
                let items = cart.items;
               	
                let gel_builder_quant = 0;
                
                for (let item of items) {
                  if (item.id == 32764401287304 && item.final_price > 0) {
                    gel_builder_quant += item.quantity;
                  }
                }
                
        
            jQuery.post('/cart/change.js', { quantity: gel_builder_quant-1, id: 32764401287304 }).then(function(res) {
      			document.documentElement.dispatchEvent(new CustomEvent('cart:refresh', {
      				bubbles: true
      			}));
      		});


                
              });
      }
        
        
  </script>
    
</body>
</html>
